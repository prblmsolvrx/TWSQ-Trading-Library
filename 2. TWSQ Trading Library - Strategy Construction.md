# Strategy Construction

## Creating a Strategy

To create a strategy using the TWSQ Trading Library, follow these steps:

1. Import the `Alpha` class from `twsq.alpha`
2. Create your strategy as a subclass of the `Alpha` class
3. Define key functions within your subclass to specify the strategy's behavior

Here's a simple example of a strategy that buys 1 ETH/USD on each rebalance:

```python
from twsq.alpha import Alpha

class ETHDCA(Alpha):
    def rebalance(self):
        self.create_order(
            'ETH/USD',
            1,
            'buy',
            route=True)
    return
```

## Key Functions

### 1. rebalance()

This is the most important function to define for each strategy. It gets executed at a certain frequency (e.g., every hour, day) that you set when running the backtester or live trader.

### 2. prepare()

Use this function to set strategy parameters and prepare for trading. It's called once before the first rebalance.

```python
def prepare(self, param1, param2):
    self.param1 = param1
    self.param2 = param2
```

### 3. on_finished_order()

This function is automatically called when an order is finished. It's useful for "market-making" or "liquidity-providing" strategies.

```python
def on_finished_order(self, order):
    # React to the finished order
    pass
```

### 4. on_exit()

This custom function runs when the trader exits. It's useful for cleanup operations.

```python
def on_exit(self):
    self.cancel_all_orders()
```

## Pre-built Functions

The `Alpha` class provides several pre-built functions that you can use in your strategy:

1. `create_order()`: Create a new order
2. `trade_to_target()`: Trade to specified target positions
3. `cancel_all_orders()`: Cancel all open orders
4. `cancel_order()`: Cancel a specific order
5. `get_open_orders()`: Get a list of open orders
6. `get_current_price()`: Get the current price of a symbol
7. `get_lastn_bars()`: Get the last n OHLCV bars of a symbol
8. `get_pos()`: Get your current positions

## Example: Using Pre-built Functions

Here's an example of how to use some of these pre-built functions:

```python
class ExampleStrategy(Alpha):
    def rebalance(self):
        # Get current price
        eth_price = self.get_current_price('ETH/USD')
        
        # Get last 5 1-hour bars
        bars = self.get_lastn_bars('ETH/USD', 5, '1h')
        
        # Make a decision based on the data
        if some_condition:
            # Create a buy order
            self.create_order('ETH/USD', 1, 'buy', route=True)
        else:
            # Cancel all open orders
            self.cancel_all_orders()
        
        # Get current positions
        positions = self.get_pos()
        print(f"Current ETH position: {positions.get('ETH', 0)}")
```

This strategy construction guide provides the foundation for creating and customizing strategies using the TWSQ Trading Library. The next sections will cover backtesting and live trading in more detail.